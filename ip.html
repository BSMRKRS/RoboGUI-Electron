<!DOCTYPE html>
<html>

<body onload='oldIP();' text='white'>

  <h1>Config IP Addresses</h1>

  <p>* Cameras ips requires quotes & refresh is needed after pressing "Okay"</p>

  <p>Cameras: <input type="text" id='cameraIP' value="'192.168.21.xxx'"></p>
  <p>Controller: <input type="text" id='controllerIP' value="192.168.21.xxx"></p>
  <p>RoboHTML: <input type="text" id='roboHTMLIP' value="192.168.21.xxx"></p>

  <input type="submit" value="Okay"
  onclick="ipSave();"/>

  <input type="submit" value="Cancel"
  onclick="window.close();"/>

</body>
<script type="text/javascript" src="ip.js"></script>
<script>
function oldIP(){
  camera = "'" + cameras[0] + "'"

  for (var i in cameras){
    if (i != 0){
      var camera = camera + ",'" + cameras[i] + "'"
    };
  };

  roboHTML = roboHTML.split("http://")

  console.log(roboHTML)

  document.getElementById('cameraIP').value = camera;
  document.getElementById('controllerIP').value = controller;
  document.getElementById('roboHTMLIP').value = roboHTML[1];
};

function ipSave(){
  camera = document.getElementById('cameraIP').value
  controller = document.getElementById('controllerIP').value
  roboHTML = document.getElementById('roboHTMLIP').value

  if (camera == '') {camera = "''"}
  if (controller == '') {controller = "''"}
  if (roboHTML == '') {roboHTML = ''}

  var fs = require('fs');

  fs.writeFile(__dirname+"/ip.js", "cameras = ["+camera+"]\ncontroller = '"+controller+"'\nroboHTML = 'http://"+roboHTML+"'", function(err) {
  if(err) {
      return console.log(err);
  }
  console.log("Saved to "+__dirname+"/ip.js");
  });

window.close()
};
</script>

<html>
