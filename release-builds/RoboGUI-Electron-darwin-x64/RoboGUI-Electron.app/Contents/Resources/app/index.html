<!DOCTYPE html>
<html>

  <head>
    <style>
    .rotateimg180 {
      -webkit-transform:rotate(180deg);
      -moz-transform: rotate(180deg);
      -ms-transform: rotate(180deg);
      -o-transform: rotate(180deg);
      transform: rotate(180deg);
    }
    </style>

    <meta charset="UTF-8">
    <title>RoboGUI-Electron</title>
  </head>

  <body onload='start();' text = 'white'>
    <script>
    const electron = require('electron');
    const path = require('path');
    const appPath = (electron.app || electron.remote.app).getPath('userData');
    const ip = appPath+"/ip.js";
    </script>

    <script type="text/javascript" id='ip'></script>
    <script>document.getElementById('ip').src=ip</script>

    <h1>RoboGUI-Electron</h1>

    <!-- Buttons -->
    <input type="submit" value="Run Controller-Support" onclick="Controller();"/>
    <input type="submit" value="Install Controller" onclick="ControllerInstall();"/>
    <input type="submit" value="Flip Cameras" onclick="cameraRotate();"/>

    <form id="RoboHTML" method="get">
      <input type="submit" value="Robo-HTML" />
    </form>

    <!-- Set of 18 cameras -->
    <p><img id='stream0'><img id='stream1'><img id='stream2'></p>
    <p><img id='stream3'><img id='stream4'><img id='stream5'></p>
    <p><img id='stream6'><img id='stream7'><img id='stream8'></p>

    <p><img id='stream9'><img id='stream10'><img id='stream11'></p>
    <p><img id='stream12'><img id='stream13'><img id='stream14'></p>
    <p><img id='stream15'><img id='stream16'><img id='stream17'></p>

    <h3>Version</h3>
    RoboGUI v1.1.0 <br />
    Node <script>document.write(process.versions.node)</script>,
    Chrome <script>document.write(process.versions.chrome)</script>,
    and Electron <script>document.write(process.versions.electron)</script>.
  </body>

  <script>
    var cameraPos = 0;

    function start(){
      camera();
      document.getElementById('RoboHTML').action=roboHTML;
    }

    function Controller(){
      require('child_process').exec("python ~/Library/'Application Support'/robogui-electron/Controller.py " + controller, function (err, stdout, stderr) {
        if (err) {
          return console.log(err);
        }
        console.log(stdout);
      });
    }

    function camera(){
      for (var i in cameras){
        document.getElementById('stream'+i.toString()).src="http://"+cameras[i]+":8080?action=stream&resolution=320x240";
        document.getElementById('stream'+i.toString()).height="240";
        document.getElementById('stream'+i.toString()).width="320";
        console.log(i + ': ' + cameras[i]);
      };
    };

    function cameraRotate(){
      cameraPos = cameraPos + 1;
      cameraPos = cameraPos % 2
      for (var i in cameras){
        if (cameraPos == 0){document.getElementById('stream'+i.toString()).className=""}
        if (cameraPos == 1){document.getElementById('stream'+i.toString()).className="rotateimg180"}
      }
    }

    function ControllerInstall(){
      require('child_process').exec("curl -o ~/Library/'Application Support'/robogui-electron/Controller.py https://raw.githubusercontent.com/avoss19/RoboGUI-Electron/master/Controller.py", function (err, stdout, stderr) {
        if (err) {
          return console.log(err);
        }
        console.log(stdout);
      });
    }

  </script>

</html>
